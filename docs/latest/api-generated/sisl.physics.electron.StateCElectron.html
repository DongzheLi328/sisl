

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>StateCElectron &mdash; sisl |release| documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> sisl
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">Other resources</a></li>
</ul>
<p class="caption"><span class="caption-text">Publications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cite.html">Citing sisl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications using sisl</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rst/files.html">File formats</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">sisl</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>StateCElectron</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api-generated/sisl.physics.electron.StateCElectron.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="statecelectron">
<h1>StateCElectron<a class="headerlink" href="#statecelectron" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="sisl.physics.electron.StateCElectron">
<em class="property">class </em><code class="descclassname">sisl.physics.electron.</code><code class="descname">StateCElectron</code><span class="sig-paren">(</span><em>state</em>, <em>c</em>, <em>parent=None</em>, <em>**info</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#StateCElectron"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.electron.StateCElectron" title="Permalink to this definition">¶</a></dt>
<dd><p>A state describing a physical quantity related to electrons, with associated coefficients of the state</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.c" title="sisl.physics.electron.StateCElectron.c"><code class="xref py py-obj docutils literal notranslate"><span class="pre">c</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.dkind" title="sisl.physics.electron.StateCElectron.dkind"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dkind</span></code></a></td>
<td>The data-type of the state (in str)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.dtype" title="sisl.physics.electron.StateCElectron.dtype"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></a></td>
<td>Data-type for the state</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.info" title="sisl.physics.electron.StateCElectron.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code></a></td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.parent" title="sisl.physics.electron.StateCElectron.parent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parent</span></code></a></td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.shape" title="sisl.physics.electron.StateCElectron.shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></a></td>
<td>Returns the shape of the state</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.state" title="sisl.physics.electron.StateCElectron.state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state</span></code></a></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.Sk" title="sisl.physics.electron.StateCElectron.Sk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sk</span></code></a>([format,&nbsp;spin])</td>
<td>Retrieve the overlap matrix corresponding to the originating parent structure.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code>(state,&nbsp;c[,&nbsp;parent])</td>
<td>Define a state container with a given set of states and coefficients for the states</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.align" title="sisl.physics.electron.StateCElectron.align"><code class="xref py py-obj docutils literal notranslate"><span class="pre">align</span></code></a>(other[,&nbsp;copy])</td>
<td>Align <em class="xref py py-obj">other.state</em> with the angles for this state, a copy of <em class="xref py py-obj">other</em> is returned with rotated elements</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.asCoefficient" title="sisl.physics.electron.StateCElectron.asCoefficient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">asCoefficient</span></code></a>()</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.asState" title="sisl.physics.electron.StateCElectron.asState"><code class="xref py py-obj docutils literal notranslate"><span class="pre">asState</span></code></a>()</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.change_gauge" title="sisl.physics.electron.StateCElectron.change_gauge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">change_gauge</span></code></a>(gauge)</td>
<td>In-place change of the gauge of the state coefficients</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.copy" title="sisl.physics.electron.StateCElectron.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</td>
<td>Return a copy (only the coefficients and states are copied), <code class="docutils literal notranslate"><span class="pre">parent</span></code> and <code class="docutils literal notranslate"><span class="pre">info</span></code> are passed by reference</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.degenerate" title="sisl.physics.electron.StateCElectron.degenerate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">degenerate</span></code></a>(eps)</td>
<td>Find degenerate coefficients with a specified precision</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.expectation" title="sisl.physics.electron.StateCElectron.expectation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expectation</span></code></a>(A[,&nbsp;diag])</td>
<td>Calculate the expectation value of matrix <em class="xref py py-obj">A</em></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.inner" title="sisl.physics.electron.StateCElectron.inner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inner</span></code></a>([right,&nbsp;diagonal,&nbsp;align])</td>
<td>Return the inner product by <span class="math notranslate nohighlight">\(\mathbf M_{ij} = \langle\psi_i|\psi'_j\rangle\)</span></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.inv_eff_mass_tensor" title="sisl.physics.electron.StateCElectron.inv_eff_mass_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inv_eff_mass_tensor</span></code></a>([as_matrix,&nbsp;eps])</td>
<td>Calculate inverse effective mass tensor for the states</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.iter" title="sisl.physics.electron.StateCElectron.iter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iter</span></code></a>([asarray])</td>
<td>An iterator looping over the states in this system</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.norm" title="sisl.physics.electron.StateCElectron.norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm</span></code></a>()</td>
<td>Return a vector with the norm of each state <span class="math notranslate nohighlight">\(\sqrt{\langle\psi|\psi\rangle}\)</span></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.norm2" title="sisl.physics.electron.StateCElectron.norm2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norm2</span></code></a>([sum])</td>
<td>Return a vector with the norm of each state <span class="math notranslate nohighlight">\(\langle\psi|\psi\rangle\)</span></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.normalize" title="sisl.physics.electron.StateCElectron.normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize</span></code></a>()</td>
<td>Return a normalized state where each state has <span class="math notranslate nohighlight">\(|\psi|^2=1\)</span></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.outer" title="sisl.physics.electron.StateCElectron.outer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">outer</span></code></a>([idx])</td>
<td>Return the outer product for the indices <em class="xref py py-obj">idx</em> (or all if <code class="docutils literal notranslate"><span class="pre">None</span></code>) by <span class="math notranslate nohighlight">\(\sum_i|\psi_i\rangle c_i\langle\psi_i|\)</span></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.phase" title="sisl.physics.electron.StateCElectron.phase"><code class="xref py py-obj docutils literal notranslate"><span class="pre">phase</span></code></a>([method,&nbsp;return_indices])</td>
<td>Calculate the Euler angle (phase) for the elements of the state, in the range <span class="math notranslate nohighlight">\(]-\pi;\pi]\)</span></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.rotate" title="sisl.physics.electron.StateCElectron.rotate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotate</span></code></a>([phi,&nbsp;individual])</td>
<td>Rotate all states (in-place) to rotate the largest component to be along the angle <em class="xref py py-obj">phi</em></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.sort" title="sisl.physics.electron.StateCElectron.sort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort</span></code></a>([ascending])</td>
<td>Sort and return a new <code class="xref py py-obj docutils literal notranslate"><span class="pre">StateC</span></code> by sorting the coefficients (default to ascending)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.spin_moment" title="sisl.physics.electron.StateCElectron.spin_moment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spin_moment</span></code></a>()</td>
<td>Calculate spin moment from the states</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.sub" title="sisl.physics.electron.StateCElectron.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sub</span></code></a>(idx)</td>
<td>Return a new state with only the specified states</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.velocity" title="sisl.physics.electron.StateCElectron.velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity</span></code></a>([eps])</td>
<td>Calculate velocity for the states</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.velocity_matrix" title="sisl.physics.electron.StateCElectron.velocity_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity_matrix</span></code></a>([eps])</td>
<td>Calculate velocity matrix for the states</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sisl.physics.electron.StateCElectron.wavefunction" title="sisl.physics.electron.StateCElectron.wavefunction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavefunction</span></code></a>(grid[,&nbsp;spinor,&nbsp;eta])</td>
<td>Expand the coefficients as the wavefunction on <em class="xref py py-obj">grid</em> <em>as-is</em></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.Sk">
<code class="descname">Sk</code><span class="sig-paren">(</span><em>format='csr'</em>, <em>spin=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.Sk" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the overlap matrix corresponding to the originating parent structure.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">self.parent</span></code> is a Hamiltonian this will return <span class="math notranslate nohighlight">\(\mathbf S(k)\)</span> for the
<span class="math notranslate nohighlight">\(k\)</span>-point these eigenstates originate from</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>format: str, optional</strong></dt>
<dd><p class="first last">the returned format of the overlap matrix. This only takes effect for
non-orthogonal parents.</p>
</dd>
<dt><strong>spin</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Spin, optional</span></dt>
<dd><p class="first last">for non-collinear spin configurations the <em>fake</em> overlap matrix returned
will have halve the size of the input matrix. If you want the <em>full</em> overlap
matrix, simply do not specify the <em class="xref py py-obj">spin</em> argument.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.align">
<code class="descname">align</code><span class="sig-paren">(</span><em>other</em>, <em>copy=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.align" title="Permalink to this definition">¶</a></dt>
<dd><p>Align <em class="xref py py-obj">other.state</em> with the angles for this state, a copy of <em class="xref py py-obj">other</em> is returned with rotated elements</p>
<p>States will be rotated by <span class="math notranslate nohighlight">\(\pi\)</span> provided the phase difference between the states are above <span class="math notranslate nohighlight">\(|\Delta\theta| &gt; \pi/2\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>other</strong> <span class="classifier-delimiter">:</span> <span class="classifier">State</span></dt>
<dd><p class="first last">the other state to align onto this state</p>
</dd>
<dt><strong>copy: bool, optional</strong></dt>
<dd><p class="first last">sometimes no states require rotation, if this is the case this flag determines whether <em class="xref py py-obj">other</em> will be
copied or not</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.asCoefficient">
<code class="descname">asCoefficient</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.asCoefficient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.asState">
<code class="descname">asState</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.asState" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="sisl.physics.electron.StateCElectron.c">
<code class="descname">c</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.change_gauge">
<code class="descname">change_gauge</code><span class="sig-paren">(</span><em>gauge</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.change_gauge" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place change of the gauge of the state coefficients</p>
<p>The two gauges are related through:</p>
<div class="math notranslate nohighlight">
\[\tilde C_j = e^{i\mathbf k\mathbf r_j} C_j\]</div>
<p>where <span class="math notranslate nohighlight">\(C_j\)</span> belongs to the gauge <code class="docutils literal notranslate"><span class="pre">R</span></code> and <span class="math notranslate nohighlight">\(\tilde C_j\)</span> is in the gauge
<code class="docutils literal notranslate"><span class="pre">r</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>gauge</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘R’, ‘r’}</span></dt>
<dd><p class="first last">specify the new gauge for the state coefficients</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy (only the coefficients and states are copied), <code class="docutils literal notranslate"><span class="pre">parent</span></code> and <code class="docutils literal notranslate"><span class="pre">info</span></code> are passed by reference</p>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.degenerate">
<code class="descname">degenerate</code><span class="sig-paren">(</span><em>eps</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.degenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Find degenerate coefficients with a specified precision</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>eps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">the precision above which coefficients are not considered degenerate</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>list of numpy.ndarray: a list of indices</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.electron.StateCElectron.dkind">
<code class="descname">dkind</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.dkind" title="Permalink to this definition">¶</a></dt>
<dd><p>The data-type of the state (in str)</p>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.electron.StateCElectron.dtype">
<code class="descname">dtype</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Data-type for the state</p>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.expectation">
<code class="descname">expectation</code><span class="sig-paren">(</span><em>A</em>, <em>diag=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.expectation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the expectation value of matrix <em class="xref py py-obj">A</em></p>
<p>The expectation matrix is calculated as:</p>
<div class="math notranslate nohighlight">
\[A_{ij} = \langle \psi_i | \mathbf A | \psi_j \rangle\]</div>
<p>If <em class="xref py py-obj">diag</em> is true, only the diagonal elements are returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>A</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">a vector or matrix that expresses the operator <em class="xref py py-obj">A</em></p>
</dd>
<dt><strong>diag</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">whether only the diagonal elements are calculated or if the full expectation
matrix is calculated</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy.ndarray</strong></dt>
<dd><p class="first last">a vector if <em class="xref py py-obj">diag</em> is true, otherwise a matrix with expectation values</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.electron.StateCElectron.info">
<code class="descname">info</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.inner">
<code class="descname">inner</code><span class="sig-paren">(</span><em>right=None</em>, <em>diagonal=True</em>, <em>align=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.inner" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inner product by <span class="math notranslate nohighlight">\(\mathbf M_{ij} = \langle\psi_i|\psi'_j\rangle\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>right</strong> <span class="classifier-delimiter">:</span> <span class="classifier">State, optional</span></dt>
<dd><p class="first last">the right object to calculate the inner product with, if not passed it will do the inner
product with itself. This object will always be the left <span class="math notranslate nohighlight">\(\langle\psi_i|\)</span></p>
</dd>
<dt><strong>diagonal</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">only return the diagonal matrix <span class="math notranslate nohighlight">\(\mathbf M_{ii}\)</span>.</p>
</dd>
<dt><strong>align</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">first align <em class="xref py py-obj">right</em> with the angles for this state (see <a class="reference internal" href="#sisl.physics.electron.StateCElectron.align" title="sisl.physics.electron.StateCElectron.align"><code class="xref py py-obj docutils literal notranslate"><span class="pre">align</span></code></a>)</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy.ndarray</strong></dt>
<dd><p class="first last">a matrix with the sum of outer state products</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This does <em>not</em> take into account a possible overlap matrix when non-orthogonal basis sets are used.</p>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.inv_eff_mass_tensor">
<code class="descname">inv_eff_mass_tensor</code><span class="sig-paren">(</span><em>as_matrix=False</em>, <em>eps=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#StateCElectron.inv_eff_mass_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.electron.StateCElectron.inv_eff_mass_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate inverse effective mass tensor for the states</p>
<p>This routine calls <em class="xref py py-obj">inv_eff_mass</em> with appropriate arguments
and returns the state inverse effective mass tensor. I.e. for non-orthogonal basis the overlap
matrix and energy values are also passed.</p>
<p>Note that the coefficients associated with the <a class="reference internal" href="#sisl.physics.electron.StateCElectron" title="sisl.physics.electron.StateCElectron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateCElectron</span></code></a> <em>must</em> correspond
to the energies of the states.</p>
<p>See <code class="xref py py-obj docutils literal notranslate"><span class="pre">inv_eff_mass_tensor</span></code> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>as_matrix</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">if true the returned tensor will be a symmetric matrix, otherwise the Voigt tensor is returned.</p>
</dd>
<dt><strong>eps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">precision used to find degenerate states.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The reason for not inverting the mass-tensor is that for systems with limited
periodicities some of the diagonal elements of the inverse mass tensor matrix
will be 0, in which case the matrix is singular and non-invertible. Therefore
it is the users responsibility to remove any of the non-periodic elements from
the matrix.</p>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.iter">
<code class="descname">iter</code><span class="sig-paren">(</span><em>asarray=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.iter" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator looping over the states in this system</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>asarray: bool, optional</strong></dt>
<dd><p class="first last">if true the yielded values are the state vectors, i.e. a numpy array.
Otherwise an equivalent object is yielded.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>state</strong> <span class="classifier-delimiter">:</span> <span class="classifier">State</span></dt>
<dd><p class="first last">a state <em>only</em> containing individual elements, if <em class="xref py py-obj">asarray</em> is false</p>
</dd>
<dt><strong>state</strong> <span class="classifier-delimiter">:</span> <span class="classifier">numpy.ndarray</span></dt>
<dd><p class="first last">a state <em>only</em> containing individual elements, if <em class="xref py py-obj">asarray</em> is true</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.norm">
<code class="descname">norm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector with the norm of each state <span class="math notranslate nohighlight">\(\sqrt{\langle\psi|\psi\rangle}\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy.ndarray</strong></dt>
<dd><p class="first last">the normalization for each state</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.norm2">
<code class="descname">norm2</code><span class="sig-paren">(</span><em>sum=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.norm2" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector with the norm of each state <span class="math notranslate nohighlight">\(\langle\psi|\psi\rangle\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>sum</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">if true the summed orbital square is returned (a vector). For false a matrix
with normalization squared per orbital is returned.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy.ndarray</strong></dt>
<dd><p class="first last">the normalization on each orbital for each state</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.normalize">
<code class="descname">normalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a normalized state where each state has <span class="math notranslate nohighlight">\(|\psi|^2=1\)</span></p>
<p>This is roughly equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">StateC</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_state</span> <span class="o">=</span> <span class="n">StateC</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">state</span> <span class="o">/</span> <span class="n">n</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">state</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_state</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>state</strong> <span class="classifier-delimiter">:</span> <span class="classifier">a new state with all states normalized, otherwise equal to this</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.outer">
<code class="descname">outer</code><span class="sig-paren">(</span><em>idx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.outer" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the outer product for the indices <em class="xref py py-obj">idx</em> (or all if <code class="docutils literal notranslate"><span class="pre">None</span></code>) by <span class="math notranslate nohighlight">\(\sum_i|\psi_i\rangle c_i\langle\psi_i|\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>idx</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or array_like, optional</span></dt>
<dd><p class="first last">only perform an outer product of the specified indices, otherwise all states are used</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>numpy.ndarray</strong> <span class="classifier-delimiter">:</span> <span class="classifier">a matrix with the sum of outer state products</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.electron.StateCElectron.parent">
<code class="descname">parent</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.parent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.phase">
<code class="descname">phase</code><span class="sig-paren">(</span><em>method='max'</em>, <em>return_indices=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Euler angle (phase) for the elements of the state, in the range <span class="math notranslate nohighlight">\(]-\pi;\pi]\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{‘max’, ‘all’}</span></dt>
<dd><p class="first last">for max, the phase for the element which has the largest absolute magnitude is returned,
for all, all phases are calculated</p>
</dd>
<dt><strong>return_indices</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">return indices for the elements used when <code class="docutils literal notranslate"><span class="pre">method=='max'</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>phi=0.0</em>, <em>individual=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate all states (in-place) to rotate the largest component to be along the angle <em class="xref py py-obj">phi</em></p>
<p>The states will be rotated according to:</p>
<div class="math notranslate nohighlight">
\[S' = S / S^\dagger_{\phi-\mathrm{max}} \exp (i \phi),\]</div>
<p>where <span class="math notranslate nohighlight">\(S^\dagger_{\phi-\mathrm{max}}\)</span> is the phase of the component with the largest amplitude
and <span class="math notranslate nohighlight">\(\phi\)</span> is the angle to align on.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">angle to align the state at (in radians), 0 is the positive real axis</p>
</dd>
<dt><strong>individual: bool, optional</strong></dt>
<dd><p class="first last">whether the rotation is per state, or a single maximum component is chosen.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.electron.StateCElectron.shape">
<code class="descname">shape</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the shape of the state</p>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.sort">
<code class="descname">sort</code><span class="sig-paren">(</span><em>ascending=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort and return a new <code class="xref py py-obj docutils literal notranslate"><span class="pre">StateC</span></code> by sorting the coefficients (default to ascending)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>ascending</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">sort the contained elements ascending, else they will be sorted descending</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.spin_moment">
<code class="descname">spin_moment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.spin_moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate spin moment from the states</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.spin_moment.html#sisl.physics.electron.spin_moment" title="sisl.physics.electron.spin_moment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spin_moment</span></code></a> with appropriate arguments
and returns the spin moment for the states.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.spin_moment.html#sisl.physics.electron.spin_moment" title="sisl.physics.electron.spin_moment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spin_moment</span></code></a> for details.</p>
</dd></dl>

<dl class="attribute">
<dt id="sisl.physics.electron.StateCElectron.state">
<code class="descname">state</code><a class="headerlink" href="#sisl.physics.electron.StateCElectron.state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.sub">
<code class="descname">sub</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new state with only the specified states</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>idx</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or array_like</span></dt>
<dd><p class="first last">indices that are retained in the returned object</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>StateC</strong> <span class="classifier-delimiter">:</span> <span class="classifier">a new object with a subset of the states</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.velocity">
<code class="descname">velocity</code><span class="sig-paren">(</span><em>eps=0.0001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#StateCElectron.velocity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.electron.StateCElectron.velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate velocity for the states</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.velocity.html#sisl.physics.electron.velocity" title="sisl.physics.electron.velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity</span></code></a> with appropriate arguments
and returns the velocity for the states. I.e. for non-orthogonal basis the overlap
matrix and energy values are also passed.</p>
<p>Note that the coefficients associated with the <a class="reference internal" href="#sisl.physics.electron.StateCElectron" title="sisl.physics.electron.StateCElectron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateCElectron</span></code></a> <em>must</em> correspond
to the energies of the states.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.velocity.html#sisl.physics.electron.velocity" title="sisl.physics.electron.velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity</span></code></a> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>eps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">precision used to find degenerate states.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.velocity_matrix">
<code class="descname">velocity_matrix</code><span class="sig-paren">(</span><em>eps=0.0001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sisl/physics/electron.html#StateCElectron.velocity_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sisl.physics.electron.StateCElectron.velocity_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate velocity matrix for the states</p>
<p>This routine calls <a class="reference internal" href="sisl.physics.electron.velocity_matrix.html#sisl.physics.electron.velocity_matrix" title="sisl.physics.electron.velocity_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity_matrix</span></code></a> with appropriate arguments
and returns the velocity for the states. I.e. for non-orthogonal basis the overlap
matrix and energy values are also passed.</p>
<p>Note that the coefficients associated with the <a class="reference internal" href="#sisl.physics.electron.StateCElectron" title="sisl.physics.electron.StateCElectron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateCElectron</span></code></a> <em>must</em> correspond
to the energies of the states.</p>
<p>See <a class="reference internal" href="sisl.physics.electron.velocity_matrix.html#sisl.physics.electron.velocity_matrix" title="sisl.physics.electron.velocity_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">velocity_matrix</span></code></a> for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>eps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">precision used to find degenerate states.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sisl.physics.electron.StateCElectron.wavefunction">
<code class="descname">wavefunction</code><span class="sig-paren">(</span><em>grid</em>, <em>spinor=0</em>, <em>eta=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sisl.physics.electron.StateCElectron.wavefunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand the coefficients as the wavefunction on <em class="xref py py-obj">grid</em> <em>as-is</em></p>
<p>See <a class="reference internal" href="sisl.physics.electron.wavefunction.html#sisl.physics.electron.wavefunction" title="sisl.physics.electron.wavefunction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavefunction</span></code></a> for argument details, the arguments not present
in this method are automatically passed from this object.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, Nick Papior

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>